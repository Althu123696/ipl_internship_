
on:
  push:
   
name: CI/CD Pipeline branches: [ "main" ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps: actions/checkout: Set up Docker Build:
      - name: Checkoutx
        uses: docker
        uses: docker code
        uses@v4

      - name/setup-buildx-action@v3

      - name: Log in to GitHub Container Registry
        with:
         
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB - name: Build and/login-action@v3 registry: ghcr.io_TOKEN }}

      push FastAPI image          IMAGE_ID
        run: |
=$(echo "ghcr.io/${{ github.repository }}/fastapi:latest" | tr '[:upper:]' '[:lower:]')
          echo "Building and"
          docker pushing $IMAGE_ID_ID" -f app/Docker build -t "$IMAGEfile .
         : Build and push
        run: |
 docker push "$IMAGE_ID"

      - name Streamlit image          IMAGE_ID=$(echo "ghcr.io" | tr '[:upper:]' '[:lower:]')
         /${{ github.repository }}/streamlit:latest echo "Building and"
          docker pushing $IMAGE_ID build -t "$IMAGE_ID" -f streamlit/Dockerfile .
          docker push "$IMAGE-latest
    needs:
      - name: Deploy_ID"

  deploy:
 uses: appleboy/ssh-action@v0.1.          host: $ username: ${{ secrets    runs-on: ubuntu: build
    steps via SSH
       10
        with:
{{ secrets.SERVER_HOST }}
         _SSH_KEY }}
          script: |
           .SERVER_USER }}
 cd /path/to/project
            git pull origin main-compose pull
            docker-compose up          key: ${{ secrets.SERVER
            docker -d
